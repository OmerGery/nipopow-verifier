\begin{algorithm}
    \label{alg:har-nipopow}
    \caption{The \textsf{NIPoPoW} client using hash-and-resubmit pattern}
    \begin{algorithmic}[1]
        \Function{\sf Constructor}{$genesis$}
            \State $Gen \gets genesis$
        \EndFunction
    \vskip8pt
    \end{algorithmic}

    \begin{algorithmic}[1]
        \Function{\sf Submit}{$\pi$, $e$}
        \State require($\pi$[0] = $Gen$)
        \State require($events[e].pred$ = false)
        \State require($validInterlink(\pi)$)
        \State $DAG_s \gets DAG_s \cup \pi$
        \State $events[e].hash$ $\gets$ sha256($\pi$)
        \Comment{enable pattern}
        \State $ancestors_s \gets findAncestors(DAG_s)$
        \State $events[e].pred \gets evaluatePredicate(ancestors_s, e)$
        \State delete $ancestors$
    \EndFunction
    \vskip8pt
    \end{algorithmic}

    \begin{algorithmic}[1]
        \Function{\sf Contest}{$\pi$, $\tilde\pi$, $e$}
        \Comment{dispatch $\pi_{sumb}^{*}\ and\ \pi_{cont}$}
        \State require($events[e].hash$ = sha256($\pi$))
        \Comment{verify $\pi_{subm}^*$}
        \State require($\tilde\pi$[0] = $Gen$)
        \State require($events[e].pred$ = true)
        \State require($validInterlink(\tilde\pi)$)
        \State $lca = findLca(\pi, \tilde\pi)$
        \State require($score(\tilde\pi[:lca]) > score(\pi[:lca])$)
        \State $DAG \gets DAG \cup \tilde\pi$
        \State $ancestors_s \gets findAncestors(DAG_s)$
        \State $events[e].pred \gets evaluatePredicate(ancestors_s, e)$
        \State delete $ancestors$
    \EndFunction
    \vskip8pt
    \end{algorithmic}
\end{algorithm}

